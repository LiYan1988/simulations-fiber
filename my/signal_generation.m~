clc;
clear;
close all;

% 400 GHz frequency span, -fmax:fmax-df
fmax = 4e11; % [Hz]
% number of spectrum points
fn = 2^20;
% spectrum resolution
df = 2*fmax/fn; % [Hz]
% spectrum axis
f = df*[(0:fn/2-1) (-fn/2:-1)];

% time window, -tmax:tmax-dt
tmax = pi/df; % [s]
% time resolution
dt = 2*tmax/fn; % [s]
% time axis
t = dt*(-fn/2:fn/2-1);

% a pulse
uu = sech(t*1e7).*exp(-0.5*1i*1*t.^2);

% plot(t, abs(uu).^2)

%---Plot input pulse shape and spectrum
temp = fftshift(ifft(uu)).*(fn*dt)/sqrt(2*pi); % spectrum
figure; subplot(2,1,1);
plot(t, abs(uu).^2, '--k'); hold on;
axis([-tmax tmax 0 max(abs(uu).^2)*2]);
xlabel('Normalized Time');
ylabel('Normalized Power');
title('Input and Output Pulse Shape and Spectrum');
subplot(2,1,2);
plot(fftshift(f)/(2*pi), abs(temp).^2, '--k'); hold on;
axis([-fmax/1e5 fmax/1e5 0 max(abs(temp).^2)*2]);
xlabel('Normalized Frequency');
ylabel('Spectral Power');
%---Store dispersive phase shifts to speedup code
% dispersion = exp(0.5i*beta2*omega.^2*deltaz); % phase factor
% hhz = 1i*N^2*deltaz; % nonlinear phase factor
%